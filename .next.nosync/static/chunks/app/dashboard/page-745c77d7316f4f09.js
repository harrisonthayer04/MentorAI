(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1431:(e,r,t)=>{"use strict";t.d(r,{default:()=>o});var a=t(5155),s=t(2115),l=t(4495);function o(){let[e,r]=(0,s.useState)(!1),[t,o]=(0,s.useState)([]);(0,s.useEffect)(()=>{try{let e=localStorage.getItem("bm_chats");e&&o(JSON.parse(e))}catch(e){}},[]),(0,s.useEffect)(()=>{try{localStorage.setItem("bm_chats",JSON.stringify(t))}catch(e){}},[t]);let n=(0,s.useMemo)(()=>[...t].sort((e,r)=>r.createdAt-e.createdAt),[t]);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{"aria-label":"Open menu",onClick:()=>r(!0),className:"fixed top-4 left-4 z-50 h-11 w-11 rounded-2xl bg-white/70 dark:bg-white/10 backdrop-blur-md border border-white/30 dark:border-white/10 shadow hover:shadow-lg transition-all text-gray-800 dark:text-gray-100 flex items-center justify-center",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,a.jsx)("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),(0,a.jsx)("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})]}),e&&(0,a.jsx)("button",{"aria-label":"Close menu",onClick:()=>r(!1),className:"fixed inset-0 z-40 bg-black/30 backdrop-blur-[2px]"}),(0,a.jsxs)("aside",{className:"fixed z-50 top-0 left-0 h-full w-72 bg-white/80 dark:bg-white/10 backdrop-blur-xl border-r border-white/40 dark:border-white/10 shadow-2xl transition-transform duration-300 ".concat(e?"translate-x-0":"-translate-x-full"),children:[(0,a.jsxs)("div",{className:"p-4 flex items-center justify-between border-b border-white/40 dark:border-white/10",children:[(0,a.jsx)("div",{className:"text-sm font-display font-semibold text-gray-900 dark:text-white",children:"Conversations"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.default,{}),(0,a.jsx)("button",{"aria-label":"Close menu",onClick:()=>r(!1),className:"h-9 w-9 rounded-xl bg-white/70 dark:bg-white/5 border border-white/30 dark:border-white/10 flex items-center justify-center text-gray-800 dark:text-gray-200",children:(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]}),(0,a.jsx)("div",{className:"p-4 border-b border-white/40 dark:border-white/10",children:(0,a.jsx)("button",{onClick:()=>{let e=Date.now(),r={id:String(e),title:"New chat ".concat(new Date(e).toLocaleTimeString()),createdAt:e};o(e=>[r,...e])},className:"w-full rounded-xl bg-[var(--color-brand)] hover:bg-[color-mix(in_oklab,var(--color-brand),black_10%)] text-white font-display font-semibold px-4 py-3 transition-colors",children:"New chat"})}),(0,a.jsx)("div",{className:"p-2 overflow-y-auto h-[calc(100vh-140px)]",children:0===n.length?(0,a.jsx)("div",{className:"px-2 py-6 text-center text-sm text-gray-600 dark:text-gray-300",children:"No chats yet"}):(0,a.jsx)("ul",{className:"space-y-1",children:n.map(e=>(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"group w-full px-3 py-2 rounded-lg hover:bg-white/60 dark:hover:bg-white/10 text-gray-900 dark:text-gray-100 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("div",{className:"truncate font-medium",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsx)("button",{"aria-label":"Delete chat",onClick:r=>{var t;r.stopPropagation(),t=e.id,o(e=>e.filter(e=>e.id!==t))},className:"opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity h-8 w-8 rounded-lg flex items-center justify-center text-gray-700 dark:text-gray-300 hover:text-red-500 hover:bg-white/70 dark:hover:bg-white/10 border border-transparent hover:border-white/40 dark:hover:border-white/10",children:(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,a.jsx)("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"}),(0,a.jsx)("path",{d:"M10 11v6"}),(0,a.jsx)("path",{d:"M14 11v6"}),(0,a.jsx)("path",{d:"M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"})]})})]})},e.id))})})]})]})}},3227:(e,r,t)=>{"use strict";t.d(r,{default:()=>d});var a=t(5155),s=t(2115),l=t(3290),o=t(744),n=t(9652),i=t(9214);function d(){let[e,r]=(0,s.useState)("gpt-5-chat"),[t,l]=(0,s.useState)(""),[o,n]=(0,s.useState)([]),[i,d]=(0,s.useState)(!1),h=async()=>{if(i)return;let r=t.trim();if(!r)return;let a=Date.now(),s={id:"u_".concat(a),role:"user",content:r,createdAt:a};n(e=>[...e,s]),l("");try{var c,h;d(!0);let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelId:e,messages:[{role:"system",content:"You are a helpful teaching assistant."},...o.map(e=>{let{role:r,content:t}=e;return{role:r,content:t}}),{role:"user",content:r}]})}),a=await t.json(),s=null!=(h=null!=(c=null==a?void 0:a.content)?c:null==a?void 0:a.error)?h:"(no response)",l={id:"a_".concat(Date.now()),role:"assistant",content:s,createdAt:Date.now()};n(e=>[...e,l])}catch(t){let e=t instanceof Error?t.message:String(t),r={id:"a_".concat(Date.now()),role:"assistant",content:"Error: ".concat(e),createdAt:Date.now()};n(e=>[...e,r])}finally{d(!1)}},u=async e=>{e.preventDefault(),await h()};return(0,a.jsx)("div",{className:"w-full px-2 md:px-4 py-2 md:py-3",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 md:gap-4 items-stretch h-[calc(100vh-1rem)] md:h-[calc(100vh-1.5rem)] overflow-hidden",children:[(0,a.jsx)("div",{className:"md:col-span-3 min-h-0 h-full",children:(0,a.jsxs)("div",{className:"h-full rounded-2xl bg-white/70 dark:bg-white/10 backdrop-blur border border-white/40 dark:border-white/10 shadow flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-white/40 dark:border-white/10",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model"}),(0,a.jsxs)("select",{value:e,onChange:e=>r(e.target.value),className:"w-full rounded-xl bg-white/70 dark:bg-gray-900/40 border border-white/40 dark:border-white/10 px-3 py-2 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-[var(--color-ring)]/40",children:[(0,a.jsx)("option",{value:"gpt-5-chat",children:"GPT-5"}),(0,a.jsx)("option",{value:"gpt-5-mini",children:"GPT-5 mini"}),(0,a.jsx)("option",{value:"gpt-5-nano",children:"GPT-5 nano"})]})]}),(0,a.jsxs)("form",{onSubmit:u,className:"p-4 mt-auto",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Your message"}),(0,a.jsx)("textarea",{value:t,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),h())},rows:5,placeholder:"Type here...",className:"w-full rounded-xl bg-white/80 dark:bg-gray-900/40 border border-white/40 dark:border-white/10 px-3 py-2 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-[var(--color-ring)]/40 resize-none"}),(0,a.jsx)("div",{className:"mt-3 flex justify-end",children:(0,a.jsx)("button",{type:"submit",className:"rounded-xl bg-[var(--color-brand)] hover:bg-[color-mix(in_oklab,var(--color-brand),black_10%)] text-white font-display font-semibold px-4 py-2 transition-colors",children:"Send"})})]})]})}),(0,a.jsx)("div",{className:"md:col-span-9 min-h-0 h-full",children:(0,a.jsx)(c,{messages:o,isLoading:i})})]})})}function c(e){let{messages:r,isLoading:t}=e,d=(0,s.useRef)(null),c=(0,s.useRef)(null),h=(0,s.useRef)(""),u=(0,s.useRef)(null),x=(0,s.useRef)(null),[b,m]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!1),w=(0,s.useCallback)(e=>e.replace(/\\\[([\s\S]*?)\\\]/g,(e,r)=>"$$".concat(r,"$$")).replace(/\\\(([\s\S]*?)\\\)/g,(e,r)=>"$".concat(r,"$")),[]),f=(0,s.useMemo)(()=>{for(let e=r.length-1;e>=0;e-=1)if("assistant"===r[e].role)return r[e].content;return""},[r]),y=(0,s.useCallback)(e=>{try{if(!("speechSynthesis"in window))return;let r=(e||"").trim();if(!r)return;window.speechSynthesis.cancel();let t=new SpeechSynthesisUtterance(r);t.rate=1,t.pitch=1,t.volume=1,window.speechSynthesis.speak(t)}catch(e){}},[]);return(0,s.useEffect)(()=>{if(c.current)c.current.scrollIntoView({behavior:"smooth",block:"end"});else{let e=d.current;if(!e)return;e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}let e=d.current;e&&p(e.scrollTop>0)},[r,t]),(0,s.useEffect)(()=>{let e=(f||"").trim();if(!e||e===h.current)return;let r=!1;return(async()=>{try{let a=await fetch("/api/tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!a.ok){y(e),h.current=e;return}let s=await a.blob();if(r)return;let l=URL.createObjectURL(s);try{var t;null==(t=u.current)||t.pause()}catch(e){}x.current&&URL.revokeObjectURL(x.current),x.current=l;let o=new Audio;o.src=l,u.current=o,o.autoplay=!0,o.onended=()=>{URL.revokeObjectURL(l),x.current===l&&(x.current=null)};try{m(!1),await o.play()}catch(e){m(!0)}h.current=e}catch(r){y(e),h.current=e}})(),()=>{r=!0}},[f,y]),(0,s.useEffect)(()=>()=>{try{var e;null==(e=u.current)||e.pause()}catch(e){}x.current&&URL.revokeObjectURL(x.current);try{"speechSynthesis"in window&&window.speechSynthesis.cancel()}catch(e){}},[]),(0,a.jsxs)("div",{className:"flex flex-col h-full rounded-2xl bg-white/70 dark:bg-white/10 backdrop-blur border border-white/40 dark:border-white/10 shadow overflow-hidden relative",children:[g&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-4 md:h-6 bg-gradient-to-b from-black/10 to-transparent dark:from-black/20 z-10"}),t&&(0,a.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"h-3 w-3 rounded-full bg-[var(--color-brand)] animate-pulse"}),(0,a.jsx)("span",{className:"h-3 w-3 rounded-full bg-[var(--color-brand)] [animation:pulse_1.2s_0.2s_infinite]"}),(0,a.jsx)("span",{className:"h-3 w-3 rounded-full bg-[var(--color-brand)] [animation:pulse_1.2s_0.4s_infinite]"})]})}),b&&(0,a.jsx)("div",{className:"absolute inset-0 z-10 flex items-end justify-center pb-6",children:(0,a.jsx)("button",{onClick:()=>{u.current&&u.current.play().then(()=>m(!1)).catch(()=>{})},className:"rounded-xl bg-[var(--color-brand)] hover:bg-[color-mix(in_oklab,var(--color-brand),black_8%)] text-white font-display font-semibold px-4 py-2 shadow-lg border border-white/30 dark:border-white/10",children:"Play response"})}),(0,a.jsxs)("div",{ref:d,className:"w-full flex-1 overflow-y-auto p-3 md:p-4 pb-8 space-y-3",onScroll:()=>{let e=d.current;e&&p(e.scrollTop>0)},children:[r.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"".concat("user"===e.role?"bg-[var(--color-brand)] text-white":"bg-white/80 dark:bg-gray-900/40 text-gray-900 dark:text-gray-100 border border-white/40 dark:border-white/10"," max-w-[80%] rounded-2xl px-4 py-2 shadow break-words"),children:(0,a.jsx)(l.oz,{remarkPlugins:[o.A,n.A],rehypePlugins:[i.A],components:{p:e=>{let{node:r,...t}=e;return(0,a.jsx)("p",{className:"mb-2 leading-relaxed",...t})},ul:e=>{let{node:r,...t}=e;return(0,a.jsx)("ul",{className:"list-disc ml-5 my-2 space-y-1",...t})},ol:e=>{let{node:r,...t}=e;return(0,a.jsx)("ol",{className:"list-decimal ml-5 my-2 space-y-1",...t})},li:e=>{let{node:r,...t}=e;return(0,a.jsx)("li",{className:"leading-relaxed",...t})},a:r=>{let{node:t,...s}=r;return(0,a.jsx)("a",{className:"".concat("user"===e.role?"text-white underline":"text-blue-700 dark:text-blue-400 underline"," break-words"),rel:"noopener noreferrer",target:"_blank",...s})},strong:e=>{let{node:r,...t}=e;return(0,a.jsx)("strong",{className:"font-semibold",...t})},em:e=>{let{node:r,...t}=e;return(0,a.jsx)("em",{className:"italic",...t})},code:r=>{let{className:t,children:s,...l}=r;return(0,a.jsx)("code",{className:"".concat("user"===e.role?"bg-white/20 text-white":"bg-black/10 dark:bg-white/10 text-inherit"," rounded px-1 py-0.5 font-mono text-[0.9em]"),...l,children:s})},pre:r=>{let{node:t,...s}=r;return(0,a.jsx)("pre",{className:"".concat("user"===e.role?"bg-white/15":"bg-black/5 dark:bg-white/5"," overflow-x-auto rounded-lg p-3 my-2"),...s})},blockquote:r=>{let{node:t,...s}=r;return(0,a.jsx)("blockquote",{className:"".concat("user"===e.role?"border-white/40":"border-black/20 dark:border-white/20"," border-l-2 pl-3 my-2 italic"),...s})},hr:r=>{let{node:t,...s}=r;return(0,a.jsx)("hr",{className:"".concat("user"===e.role?"border-white/20":"border-black/10 dark:border-white/10"," my-3"),...s})},table:e=>{let{node:r,...t}=e;return(0,a.jsx)("div",{className:"overflow-x-auto my-2",children:(0,a.jsx)("table",{className:"table-auto border-collapse text-sm",...t})})},th:e=>{let{node:r,...t}=e;return(0,a.jsx)("th",{className:"border px-2 py-1",...t})},td:e=>{let{node:r,...t}=e;return(0,a.jsx)("td",{className:"border px-2 py-1 align-top",...t})}},children:w(e.content)})})},e.id)),t&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-white/80 dark:bg-gray-900/40 text-gray-900 dark:text-gray-100 border border-white/40 dark:border-white/10 max-w-[80%] rounded-2xl px-4 py-2 shadow",children:"Thinkingâ€¦"})}),(0,a.jsx)("div",{ref:c})]})]})}},4495:(e,r,t)=>{"use strict";t.d(r,{default:()=>l});var a=t(5155),s=t(2115);function l(){let[e,r]=(0,s.useState)(!1),[t,l]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l(!0);let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,a=e?"dark"===e:t;r(a),a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[]),t)?(0,a.jsx)("button",{onClick:()=>{let t=!e;r(t),t?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},className:"p-3 rounded-2xl bg-gray-200/50 dark:bg-gray-700/50 backdrop-blur-sm border border-gray-300/30 dark:border-gray-600/30 text-gray-800 dark:text-gray-200 hover:bg-gray-300/50 dark:hover:bg-gray-600/50 transition-all duration-200 shadow-lg","aria-label":"Toggle theme",children:e?(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}):(0,a.jsx)("div",{className:"w-9 h-9 rounded-2xl"})}},5509:(e,r,t)=>{Promise.resolve().then(t.bind(t,3227)),Promise.resolve().then(t.bind(t,1431))}},e=>{e.O(0,[330,803,441,964,358],()=>e(e.s=5509)),_N_E=e.O()}]);